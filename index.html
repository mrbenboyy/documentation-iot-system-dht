<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Project Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 text-gray-900">
    <div class="flex">
        <!-- Sidebar -->
        <div class="w-64 bg-gray-800 text-white h-screen fixed">
            <div class="p-4">
                <h1 class="text-2xl font-bold">IoT Project</h1>
                <p class="text-sm text-gray-400">Documentation</p>
            </div>
            <nav class="mt-6">
                <ul>
                    <li>
                        <a href="#introduction" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-home mr-2"></i> Introduction
                        </a>
                    </li>
                    <li>
                        <a href="#project-structure" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-folder-open mr-2"></i> Project Structure
                        </a>
                    </li>
                    <li>
                        <a href="#setup" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-cogs mr-2"></i> Setup
                        </a>
                    </li>
                    <li>
                        <a href="#configuration" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-tools mr-2"></i> Configuration
                        </a>
                    </li>
                    <li>
                        <a href="#node-red" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-project-diagram mr-2"></i> Node-RED
                        </a>
                    </li>
                    <li>
                        <a href="#usage" class="flex items-center p-2 hover:bg-gray-700">
                            <i class="fas fa-play-circle mr-2"></i> Usage
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="ml-64 p-8 w-full">
            <!-- Introduction -->
            <section id="introduction" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Introduction</h2>
                <p class="mb-4">This project demonstrates how to set up an IoT system to monitor temperature and
                    humidity using simulated sensor data. The system consists of the following components:</p>
                <ul class="list-disc list-inside mb-4">
                    <li>Python script to simulate sensor data</li>
                    <li>Mosquitto MQTT broker</li>
                    <li>InfluxDB for data storage</li>
                    <li>Grafana for data visualization</li>
                    <li>Node-RED for data flow management</li>
                </ul>
                <p class="mb-4">The project is containerized using Docker for easy setup and deployment.</p>
            </section>

            <!-- Project Structure -->
            <section id="project-structure" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Project Structure</h2>
                <p class="mb-4">The project is organized into the following folders and files:</p>
                <div class="bg-gray-200 p-4 rounded mb-4">
                    <pre><code>
Projet_IoT/
├── python_sensor/
│   └── dht_sensor.py
├── docker_config/
│   ├── mosquitto/
│   │   ├── config/
│   │   │   └── mosquitto.conf
│   │   ├── data/
│   │   └── log/
│   ├── influxdb/
│   │   └── data/
│   ├── grafana/
│   │   └── data/
│   └── docker-compose.yml
├── node-red_flows/
│   └── flows.json
└── documentation
                    </code></pre>
                </div>
                <p class="mb-4">Each folder and file serves a specific purpose in the project:</p>
                <ul class="list-disc list-inside mb-4">
                    <li><code>python_sensor/</code>: Contains the Python script to simulate sensor data.</li>
                    <li><code>docker_config/</code>: Contains Docker configurations and data for Mosquitto, InfluxDB,
                        and Grafana.</li>
                    <li><code>node-red_flows/</code>: Contains Node-RED flow configurations.</li>
                    <li><code>documentation/</code>: Contains the project documentation.</li>
                </ul>
            </section>

            <!-- Setup -->
            <section id="setup" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Setup</h2>
                <p class="mb-4">To set up the project, follow these steps:</p>
                <ol class="list-decimal list-inside mb-4">
                    <li>Clone the project repository.</li>
                    <li>Install Docker and Docker Compose if not already installed.</li>
                    <li>Navigate to the project directory and run <code
                            class="bg-gray-200 p-1 rounded">docker-compose up -d</code>.</li>
                </ol>
                <img src="docker_containers.PNG" alt="Docker Containers" class="mb-4 rounded-lg shadow-lg">
                <p class="mb-4">This will start the Mosquitto, InfluxDB, and Grafana services.</p>
            </section>

            <!-- Configuration -->
            <section id="configuration" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Configuration</h2>
                <p class="mb-4">Configure each component as follows:</p>

                <h3 class="text-2xl font-semibold mb-2">Mosquitto</h3>
                <p class="mb-4">The Mosquitto configuration file is located at <code
                        class="bg-gray-200 p-1 rounded">mosquitto/config/mosquitto.conf</code>. It is configured to
                    allow anonymous connections.</p>
                <img src="mosquitto_config.png" alt="Mosquitto Configuration" class="mb-4 rounded-lg shadow-lg">

                <h3 class="text-2xl font-semibold mb-2">InfluxDB</h3>
                <p class="mb-4">InfluxDB is configured with the following environment variables in the <code
                        class="bg-gray-200 p-1 rounded">docker-compose.yml</code> file:</p>
                <pre class="bg-gray-200 p-4 rounded mb-4"><code>
DOCKER_INFLUXDB_INIT_MODE=setup
DOCKER_INFLUXDB_INIT_USERNAME=abdelhakim_benbouanane
DOCKER_INFLUXDB_INIT_PASSWORD=hakim123@
DOCKER_INFLUXDB_INIT_ORG=IoT_Mundia
DOCKER_INFLUXDB_INIT_BUCKET=mybucket
                </code></pre>
                <img src="influxdb_data_explorer.png" alt="InfluxDB Data Explorer" class="mb-4 rounded-lg shadow-lg">

                <h3 class="text-2xl font-semibold mb-2">Grafana</h3>
                <p class="mb-4">Grafana is configured to connect to InfluxDB. Use the following settings:</p>
                <pre class="bg-gray-200 p-4 rounded mb-4"><code>
URL: http://influxdb:8086
Organization: IoT_Mundia
Token: admin:admin123
Bucket: mybucket
                </code></pre>
                <img src="grafana_connection.png" alt="Grafana Connection" class="mb-4 rounded-lg shadow-lg">
            </section>

            <!-- Node-RED -->
            <section id="node-red" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Node-RED</h2>
                <p class="mb-4">Node-RED is used to manage the data flow in this project. It receives data from the MQTT
                    broker, processes it, and stores it in InfluxDB.</p>
                <h3 class="text-2xl font-semibold mb-2">Flow Overview</h3>
                <p class="mb-4">The Node-RED flow consists of the following steps:</p>
                <ol class="list-decimal list-inside mb-4">
                    <li><strong>MQTT Input</strong>: Receives data from the MQTT broker on the topic
                        <code>sensor/data</code>.
                    </li>
                    <li><strong>Parse Data</strong>: Parses the incoming payload (temperature and humidity) into a JSON
                        object.</li>
                    <li><strong>InfluxDB Output</strong>: Stores the parsed data in InfluxDB under the measurement
                        <code>sensor_data</code>.
                    </li>
                </ol>
                <img src="node-red_flux.png" alt="Node-RED Flow" class="mb-4 rounded-lg shadow-lg">
                <p class="mb-4">Here is the JSON representation of the Node-RED flow:</p>
                <pre class="bg-gray-200 p-4 rounded mb-4"><code>
[
    {
        "id": "f1b1c1a0.1b1b1",
        "type": "mqtt in",
        "z": "d1b1c1a0.1b1b1",
        "name": "",
        "topic": "sensor/data",
        "qos": "0",
        "datatype": "auto",
        "broker": "b1b1c1a0.1b1b1",
        "x": 150,
        "y": 100,
        "wires": [
            [
                "f2b1c1a0.1b1b1"
            ]
        ]
    },
    {
        "id": "f2b1c1a0.1b1b1",
        "type": "function",
        "z": "d1b1c1a0.1b1b1",
        "name": "Parse Data",
        "func": "var parts = msg.payload.split(',');\nvar temperature = parseFloat(parts[0].split(':')[1]);\nvar humidity = parseFloat(parts[1].split(':')[1]);\nmsg.payload = {\n    temperature: temperature,\n    humidity: humidity\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 350,
        "y": 100,
        "wires": [
            [
                "f3b1c1a0.1b1b1"
            ]
        ]
    },
    {
        "id": "f3b1c1a0.1b1b1",
        "type": "influxdb out",
        "z": "d1b1c1a0.1b1b1",
        "influxdb": "c1b1c1a0.1b1b1",
        "name": "",
        "measurement": "sensor_data",
        "x": 550,
        "y": 100,
        "wires": []
    }
]
                </code></pre>
                <p class="mb-4">This flow ensures that the sensor data is correctly processed and stored for
                    visualization in Grafana.</p>
            </section>

            <!-- Usage -->
            <section id="usage" class="mb-8">
                <h2 class="text-3xl font-bold mb-4">Usage</h2>
                <p class="mb-4">Once the services are running, you can start sending simulated sensor data using the
                    Python script:</p>
                <pre class="bg-gray-200 p-4 rounded mb-4"><code>
import random
import time
import paho.mqtt.client as mqtt

broker = "localhost"
port = 1883
topic = "sensor/data"

client = mqtt.Client()
client.connect(broker, port)

while True:
    temperature = random.uniform(20.0, 30.0)
    humidity = random.uniform(50.0, 60.0)
    payload = f"temperature:{temperature},humidity:{humidity}"
    client.publish(topic, payload)
    print(f"Published: {payload}")
    time.sleep(5)
                </code></pre>
                <img src="python_script.png" alt="Python Script" class="mb-4 rounded-lg shadow-lg">

                <p class="mb-4">The data will be sent to the MQTT broker, processed by Node-RED, stored in InfluxDB, and
                    visualized in Grafana.</p>
                <img src="dashboard.png" alt="Grafana Dashboard" class="mb-4 rounded-lg shadow-lg">
                <img src="dashboard_gauge.png" alt="Grafana Dashboard" class="mb-4 rounded-lg shadow-lg">
            </section>
        </div>
    </div>
</body>

</html>